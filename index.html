<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>å¤œå–°ã‚‰ã„ã®è¿·å®®</title>

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:system-ui;
  text-align:center;
}

/* ---------- ã‚¿ã‚¤ãƒˆãƒ« ---------- */
#top{
  padding-top:60px;
}
#startBtn{
  margin-top:30px;
  display:inline-block;
  padding:14px 28px;
  background:#1e90ff;
  border-radius:8px;
  font-size:20px;
  user-select:none;
}

/* ---------- ã‚²ãƒ¼ãƒ  ---------- */
#game{
  display:none;
}
#ui{
  margin:12px 0;
}
#map{
  display:grid;
  grid-template-columns:repeat(10,24px);
  grid-template-rows:repeat(10,24px);
  gap:2px;
  justify-content:center;
}

.cell{
  width:24px;
  height:24px;
  background:#111;
}
.wall{background:#333;}
.player{background:#00aaff;}
.stairs{background:#00cc44;}
.enemy{background:#cc0000;}
.dark{filter:brightness(0.2);}
</style>
</head>

<body>

<!-- ===== ã‚¿ã‚¤ãƒˆãƒ« ===== -->
<div id="top">
  <h1>ğŸŒ™ å¤œå–°ã‚‰ã„ã®è¿·å®®</h1>
  <!-- ZIPæ–‡è¨€ã¯å­˜åœ¨ã—ãªã„ -->
  <div id="startBtn" ontouchstart="startGame()">â–¶ å†’é™ºé–‹å§‹</div>
</div>

<!-- ===== ã‚²ãƒ¼ãƒ ç”»é¢ ===== -->
<div id="game">
  <div id="ui"></div>
  <div id="map"></div>
</div>

<script>
/* ---------- å–å¾— ---------- */
const mapDiv = document.getElementById("map");
const ui = document.getElementById("ui");
const topDiv = document.getElementById("top");
const gameDiv = document.getElementById("game");

/* ---------- çŠ¶æ…‹ ---------- */
const size = 10;
let map = [];
let px = 1, py = 1;
let hp = 10;
let floor = 1;

/* ---------- ç”Ÿæˆ ---------- */
function gen(){
  map=[];
  for(let y=0;y<size;y++){
    const r=[];
    for(let x=0;x<size;x++){
      r.push(Math.random()<0.15 ? "#" : ".");
    }
    map.push(r);
  }
  map[1][1]="P";
  map[size-2][size-2]=">";
}

/* ---------- æç”» ---------- */
function draw(){
  mapDiv.innerHTML="";
  for(let y=0;y<size;y++){
    for(let x=0;x<size;x++){
      let c="cell";
      if(map[y][x]==="#") c+=" wall";
      if(x===px && y===py) c+=" player";
      if(map[y][x]===">") c+=" stairs";

      // è¦–ç•Œåˆ¶é™ï¼ˆå¤œãƒ•ãƒ­ã‚¢ï¼‰
      if(Math.abs(px-x)+Math.abs(py-y)>2) c+=" dark";

      mapDiv.innerHTML+=`<div class="${c}"></div>`;
    }
  }
  ui.textContent=`${floor}F  â¤ï¸HP:${hp}`;
}

/* ---------- é–‹å§‹ ---------- */
function startGame(){
  topDiv.style.display="none";
  gameDiv.style.display="block";
  gen();
  draw();
}

/* ---------- ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ ---------- */
document.addEventListener("keydown",e=>{
  let dx=0,dy=0;
  if(e.key==="ArrowUp")dy=-1;
  if(e.key==="ArrowDown")dy=1;
  if(e.key==="ArrowLeft")dx=-1;
  if(e.key==="ArrowRight")dx=1;

  const nx=px+dx, ny=py+dy;
  if(nx<0||ny<0||nx>=size||ny>=size) return;
  if(map[ny][nx]==="#") return;

  px=nx; py=ny;

  if(map[ny][nx]===">"){
    floor++;
    px=1; py=1;
    gen();
  }
  draw();
});
</script>

</body>
</html>
